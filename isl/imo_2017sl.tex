\documentclass[11pt,a4paper]{article}
\usepackage{amsmath, amssymb, fullpage, mathrsfs, bm, pgf, tikz}
\usepackage{mathrsfs}
\usetikzlibrary{arrows}
\setlength{\textheight}{10in}
%\setlength{\topmargin}{0in}
\setlength{\topmargin}{-0.5in}
\setlength{\parskip}{0.1in}
\setlength{\parindent}{0in}

\begin{document}
\newcommand{\la}{\leftarrow}
\newcommand{\lra}{\leftrightarrow}
\newcommand{\bbR}{\mathbb{R}}
\newcommand{\bbN}{\mathbb{N}}
\newcommand{\ord}{\text{ord}}

\title{Solution to IMO 2017 shortlisted problems.}
\author{Anzo Teh}
\date{}
\maketitle

Introduction: similar to last year I plan to do writeups on the problems that I nailed on this shortlist booklet. The only exception is that this problem sheet is harder than that of 2016 (C5 was on the IMO and almost everyone got 0), so I can anticipate that the progress to bit somewhat slower than last year. (Edit: will add more from time to time, as my schedule permits!)


% TODO: more like note for myself!
\iffalse
TODO: 


A6: 
Let $\mathbb{R}$ be the set of real numbers. Determine all functions $f: \mathbb{R} \rightarrow \mathbb{R}$ such that, for any real numbers $x$ and $y$,\[ f(f(x)f(y)) + f(x+y) = f(xy). \]

C4: 
An integer $N \ge 2$ is given. A collection of $N(N + 1)$ soccer players, no two of whom are of the same height, stand in a row. Sir Alex wants to remove $N(N - 1)$ players from this row leaving a new row of $2N$ players in which the following $N$ conditions hold:
($1$) no one stands between the two tallest players,
($2$) no one stands between the third and fourth tallest players,
$\;\;\vdots$
($N$) no one stands between the two shortest players.

Show that this is always possible.

G6: 
Let $n\ge3$ be an integer. Two regular $n$-gons $\mathcal{A}$ and $\mathcal{B}$ are given in the plane. Prove that the vertices of $\mathcal{A}$ that lie inside $\mathcal{B}$ or on its boundary are consecutive.

(That is, prove that there exists a line separating those vertices of $\mathcal{A}$ that lie inside $\mathcal{B}$ or on its boundary from the other vertices of $\mathcal{A}$.)

N6: 
Find the smallest positive integer $n$ or show no such $n$ exists, with the following property: there are infinitely many distinct $n$-tuples of positive rational numbers $(a_1, a_2, \ldots, a_n)$ such that both
$$a_1+a_2+\dots +a_n \quad \text{and} \quad \frac{1}{a_1} + \frac{1}{a_2} + \dots + \frac{1}{a_n}$$are integers.
\fi

\newpage
\section{Algebra}
\begin{enumerate}
	\item[\textbf{A1}]Let $a_1,a_2,\ldots a_n,k$, and $M$ be positive integers such that
	$$\frac{1}{a_1}+\frac{1}{a_2}+\cdots+\frac{1}{a_n}=k\quad\text{and}\quad a_1a_2\cdots a_n=M.$$If $M>1$, prove that the polynomial
	$$P(x)=M(x+1)^k-(x+a_1)(x+a_2)\cdots (x+a_n)$$has no positive roots.
	
	\textbf{Solution.} We will actually prove that $(x+a_1)(x+a_2)\cdots (x+a_n) > M(x+1)^k$ for all $x > 0$. 
	Now, dividing by $M$ on both sides (i.e. dividing by $a_1a_2\cdots a_n$ on the left hand side) (bearing in mind that $M$ is positive) we get that the desired inequality is equivalent to 
	$(1+\frac{x}{a_1})(1+\frac{x}{a_2})\cdots (1+\frac{x}{a_n}) = \frac{x+a_1}{a_1}\cdot\frac{x+a_2}{a_2}\cdots \frac{x+a_n}{a_n} > (x+1)^k$. 
	
	Before we proceed, we prove a key fact: for all $x > 0$ and all $i$ we have $(1+\frac{x}{a_i})^{a_i} \ge 1+x$, with equality happening if and only if $a_i = 1$. Here I will show two proofs to it: 
	\begin{itemize}
		\item Expanding the left hand side (thankfully $a_i$ is a positive integer) gives 
		\[(1+\frac{x}{a_i})^{a_i}=\sum_{j=0}^{a_i}\binom{a_i}{j}x^j=1+x+\sum_{j=2}^{a_i}\binom{a_i}{j}x^j\]
		Clearly the last term is positive if $x>0$ and $a_i>1$. 
		\item Consider the expression $f(x)=(1+\frac{x}{a_i})^{a_i} - (1+x)$, where $f(0)=0$ and $f'(x)=(1+\frac{x}{a_i})^{a_i-1}-1$. This derivative is positive if $x>0$ and $a_i-1>0$ (i.e. $a_i=1$), which will follow that $f(x)>0$ for all $x>0$ if $a_i>1$. 
	\end{itemize}
Thus we have $(1+\frac{x}{a_i}) \ge (1+x)^{\frac{1}{a_i}}$ for all $x>0$ with equality iff $a_i=1$. This means, 
$(1+\frac{x}{a_1})(1+\frac{x}{a_2})\cdots (1+\frac{x}{a_n}) \ge (x+1)^{\frac{1}{a_1}+\frac{1}{a_2}+\cdots + \frac{1}{a_n}}=(x+1)^k$, with equality iff $a_i=1$ for all $i$. This cannot happen, otherwise $M=1$. So the strict inequality always holds. 

\item [\textbf{A2}] Let $q$ be a real number. Gugu has a napkin with ten distinct real numbers written on it, and he writes the following three lines of real numbers on the blackboard:
	\begin{itemize}
		\item In the first line, Gugu writes down every number of the form $a-b$, where $a$ and $b$ are two(not necessarily distinct) numbers on his napkin.
		\item In the second line, Gugu writes down every number of the form $qab$, where $a$ and $b$ are
		two (not necessarily distinct) numbers from the first line.
		\item In the third line, Gugu writes down every number of the form $a^2+b^2-c^2-d^2$, where
		$a, b, c, d$ are four (not necessarily distinct) numbers from the first line.
	\end{itemize}
	Determine all values of $q$ such that, regardless of the numbers on Gugu's napkin, every number in the second line is also a number in the third line.
	
	\textbf{Answer.} $0$ and $\pm 2$. \\
	\textbf{Solution.} Let $a_1, \cdots , a_{10}$ be the numbers on the napkin. Then the numbers on the first line are in the form of $a_i - a_j$ with $1\le i, j\le 10$. Thus all the numbers on the second line are in the form of $q(a_i - a_j)(a_k-a_\ell)$, and the numbers on the third line is in the form of $(a_{11}-a_{12})^2 + (a_{21}-a_{22})^2 - (a_{31}-a_{32})^2 - (a_{41}-a_{42})^2$. Thus letting $q=0$ yields all numbers on the second line as 0, which we can choose $a_{11}=a_{12}=\cdots = a_{41}=a_{42}$. Now for $q=2$ we have 
	$2(a_i - a_j)(a_k-a_\ell)=(a_j-a_k)^2 + (a_i-a_\ell)^2 - (a_i-a_k)^2 - (a_j-a_\ell)^2$ and for $q=-2$ we have 
	$(a_i - a_j)(a_k-a_\ell)= (a_i-a_k)^2 + (a_j-a_\ell)^2 - (a_j-a_k)^2 - (a_i-a_\ell)^2$. Thus these are all valid values. 
	
	To show that these are the only values, consider when $a_i=i$, so the numbers on the first line are $-9, -8, \cdots , 8, 9$. Thus $q(1)(1)=q$ is on the second line, and all numbers on the third line are integers. It then follows that $q$ is an integer. Next, $q(9)(9)=9^2\cdot q$ is on the second line while the numbers on the third line cannot exceed $9^2+9^2=2\cdot 9^2$ and cannot be less than $-(9^2+9^2)=-2\cdot 9^2$. It then follows that $-2\le q\le 2$. This left with 5 choices: $-2, -1, 0, 1, 2$. Finally, to see why $\pm 1$ doesn't work, consider a new sequence $-\pi, 0, 1, \cdots , 8$ on the napkin, so the first line contains the numbers $\pm(i + \pi j)$ where $i\in \{0, 1, \cdots , 8\}$ and $j\in\{0, 1\}$. Therefore the number $q(1)(1+\pi)=q+q\pi$ is indeed on the second line. The numbers on the third line are in the form of $a\pi^2+b\pi + c$. Notice that $b$ must be even, since each of the summand $\pm (i+\pi j)^2=\pm (i^2+2\pi ij + \pi^2 j^2)$, with the coefficient of $\pi$ equal to $2ij$, which is even. Now there must be a combination of the four numbers that gives $a=0$, $b=c=q$ since $\pi$ is transcendental (i.e. $a'\pi^2+b'\pi+c'=0$ means that $a'=b'=c'=0$). The fact that $b$ must be even means that $q$ must also be even, so $q=\pm 1$ doesn't work. 
	
	\item [\textbf{A3}] Let $S$ be a finite set, and let $\mathcal{A}$ be the set of all functions from $S$ to $S$. Let $f$ be an element of $\mathcal{A}$, and let $T=f(S)$ be the image of $S$ under $f$. Suppose that $f\circ g\circ f\ne g\circ f\circ g$ for every $g$ in $\mathcal{A}$ with $g\ne f$. Show that $f(T)=T$.
	
	\textbf{Solution.} Now consider arbitrary $x$ and consider the sequence $a_k=f^{k}(x)$, with $k\ge 0$. Since $S$ is finite, $f^{i}(x)=f^{j}(x)$ for some $i\neq j$, and subsequently $f^{i+k}(x)=f^{j+k}(x)$ for all $k\ge 0$. This means that this sequence $a_k$ is eventually periodic. Now we determine the minimal such $i$, namely $m(x)$, such that $f$ is periodic from this $i:=m(x)$. Also let $t(x)$ be the minimal index such that $f^{i}(x)=f^{i+t(x)}(x)$ for all $i\ge m(x)$. Clearly, $a_k\in T=f(S)$ if and only if $k\ge \min(m(x), 1)$, and $a_k\in f(T)=f(f(S))$ if and only if $k\ge\min(m(x), 2)$ (in general, $a_k\in f^{\ell}(S)$) iff $k\ge \min(m(x), \ell)$. 
	
	Consider $g(x)$ defined in such a manner: 
	\begin{itemize}
		\item If $m(x)\le 1$, then $g(x)=f(x)$. 
		\item Otherwise, $g(x)=f^{m(x)t(x)+1}(x)$. 
		\end{itemize}
	Observe that if $m(x)=1$ then $g(x)=f(x)=f^{t(x)+1}(x)=f^{m(x)t(x)+1}(x)$ so $g(x)=f^{m(x)t(x)+1}(x)$ would hold for all $x$ with $m(x)\ge 1$. Also $m(g(x))=0$ for all $m(x)\ge 1$, since in this case we have $m(x)t(x)+1>m(x)$. 
	We first show that $f\circ g\circ f=g\circ f\circ g$. If $m(x)\le 1$, then $m(f^{k}(x))=0$ for all $k\ge 1$, and thus $f\circ g\circ f(x)=g\circ f\circ g(x)=f^{3}(x)$. Otherwise, $m(f(x))=m(x)-1\ge 1$ (and $t(f(x))=t(x)$ so we have $f\circ g\circ f(x)=f\circ (f^{(m(x)-1)t(x)+1}f(x))=f^{(m(x)-1)t(x)+2}f(x)=f^{(m(x)-1)t(x)+3}(x)=f^{m(x)t(x)+3}(x)$, and 
	$g\circ f\circ g(x)=g\circ f f^{m(x)t(x)+1}(x) = g\circ f^{m(x)t(x)+2}(x)=f^{m(x)t(x)+3}(x)$
	Now we also have $f(T)\neq T$ if and only if $m(x)\ge 2$ for some $x$. Here, $m(f(x))=m(x)-1\ge 1$ while $m(g(x))=0$ as before, so $f\neq g$. Thus this $g$ is a legitimate counterexample when $f(T)\neq T$. 
	
	\item [\textbf{A4}] A sequence of real numbers $a_1,a_2,\dots$ satisfies the relation
	$$a_n=-\max_{i+j=n}(a_i+a_j)\qquad\text{for all}\quad n>2017.$$
	Prove that the sequence is bounded, i.e., there is a constant $M$ such that $|a_n|\leq M$ for all positive integers $n$.
	
	\textbf{Solution.} Suppose that it is unbounded. We first prove that it has to be unbounded in both directions (positive and negative). Indeed, if for any $M>\max\{|a_1|, \cdots , |a_{2017}|\}$ there exists $a_n>M$ (so $n>2017$), then from $a_i+a_j=-a_n<-M$ for some $i, j$ with $i+j=n$ we get $\min\{a_i, a_j\}<\frac{-M}{2}$. Similarly if for any $M>\max\{|a_1|, \cdots , |a_{2017}|\}$ there exists $a_n<-M$ then from $a_i+a_j=-a_n>M$ for some $i, j$ with $i+j=n$ we get $\max\{a_i, a_j\}>\frac{M}{2}$. Thus if the sequence is unbounded in any direction, it has to be unbounded in the opposite direction, too. 
	
	Now let $a_n$ to be the first number in the sequence greater than $M=\max\{|a_1|, \cdots , |a_{2017}|\}$, and by the unboundedness of the sequence there must also exist $m$ with $a_m>a_n$; we shall assume in the rest of the proof that this $m$ is minimal possible. The fact that $a_n<a_m=-\max_{i+j=m} (a_i+a_j)$ means that whenever $i+j=m$ we have $a_i+a_j\le -a_m$. In particular, $a_{n-i}\le -a_m-a_n<-a_n-a_n = -2a_n$. This implies the existence of an integer $k$ (take $k=n-i$) less than $m$ such that $a_{k}<-2a_n$, which also implies that $a_k<-\max\{|a_1|, \cdots , |a_{2017}|\}$, so $k>2017$. This would mean $a_k=-(a_i+a_j)$ for some $i, j$ with $i+j=k$ by the definition of max, so $a_i+a_j=-a_k>2a_n$ as $a_k<-2a_n$. Thus we have $\max\{a_i, a_j\}>a_n$. Since $i, j<m$, this will contradict the fact that $m$ is the minimal possible index with $a_m>a_n$. Hence the proof is complete with contradiction reached. 
	
	\item[\textbf{A5}]
	An integer $n \geq 3$ is given. We call an $n$-tuple of real numbers $(x_1, x_2, \dots, x_n)$ Shiny if for each permutation $y_1, y_2, \dots, y_n$ of these numbers, we have
	$$\sum \limits_{i=1}^{n-1} y_i y_{i+1} = y_1y_2 + y_2y_3 + y_3y_4 + \cdots + y_{n-1}y_n \geq -1.$$Find the largest constant $K = K(n)$ such that
	$$\sum \limits_{1 \leq i < j \leq n} x_i x_j \geq K$$holds for every Shiny $n$-tuple $(x_1, x_2, \dots, x_n)$.	
	
	\textbf{Answer.} $-(\frac{n-1}{2})$. 
	
	\textbf{Solution.} 
	We first show that this $K$ cannot be improved. 
	Consider $\epsilon>0$ be arbitrarily small, 
	and $x_1=\cdots = x_{n-1}=\epsilon, x_{n}=\frac{-1}{2\epsilon}$. 
	Then for permutation $y_1, \cdots, y_n$ of $x_1, \cdots, y_n$ we have 
	\[
	\sum \limits_{i=1}^{n-1} y_i y_{i+1} = 
	\begin{cases}
	  -\frac 12 + (n-2)\epsilon^2 & y_1=\frac{-1}{2\epsilon}\text{ or }y_n=\frac{-1}{2\epsilon}\\
	  -1+(n-3)\epsilon^2 & \text{otherwise}\\
	\end{cases}
	\]
	and is hence shiny. 
	On the other hand, 
	\[
	\sum \limits_{1 \leq i < j \leq n} x_i x_j 
	=-\frac{n-1}{2} + \binom{n-1}{2}\epsilon^2
	\]
	which can be made arbitrarily close to $-\frac{n-1}{2}$. 
	
	Now to prove the bound, we'll show that average of $x_ix_j$ for $i\neq j$ 
	is at least $-\frac{1}{n}$. 
	Consider, now, putting the $x_i$'s on a circle in an arbitrary fashion, 
	and label $y_1, \cdots, y_n$ in that order. 
	
	\emph{Case 1.} 
	If there are two neighbouring numbers with same sign, 
	i.e. both $\ge 0$ or both $<0$, 
	then we can make those two as $y_1$ and $y_n$. 
	It then follows that 
	\[
	\sum_{i=1}^{n-1}y_iy_{i+1}+y_1y_n\ge -1+0=-1
	\]
	so the average of the numbers $x_ix_j$ in this circular arrangement is indeed $\ge \frac{-1}{n}$. 
	
	\emph{Case 2.} 
	If each of the neighbouring numbers have alternating sign, 
	then we're in the situation where $n$ is even and exactly half are nonnegative. 
	Consider $\mathbb{E}(x_ix_j|\text{Cond})$, 
	the average of $x_ix_j$ under the condition $\text{Cond}$. 
	Then $\mathbb{E}(x_ix_j|x_ix_j\ge 0)\ge 0$, 
	and by considering all the permutations $y_1, \cdots, y_{2n}$ of alternating signs, 
	we have $\mathbb{E}(x_ix_j|x_ix_j< 0)\ge \frac{-1}{n-1}$. 
	But then there are $\frac{n^2}{4}$ pairs of $x_ix_j$ with $<0$ product, 
	and $\frac{n(n-2)}{4}$ pairs with $\ge 0$ product. 
	It then follows that the overall average is at least 
	\[
	\frac{n^2}{2n(n-1)}\cdot \frac{-1}{n-1}=-\frac{n}{2(n-1)^2} > -\frac{1}{n}
	\]
	as desired. 
\end{enumerate}

\section{Combinatorics}
\begin{enumerate}
	\item[\textbf{C1}] A rectangle $\mathcal{R}$ with odd integer side lengths is divided into small rectangles with integer side lengths. Prove that there is at least one among the small rectangles whose distances from the four sides of $\mathcal{R}$ are either all odd or all even. 
	
	\textbf{Solution.} Consider partitioning this big rectangle into small squares of side length 1, and colour it in the chessboard fashion, with the corners being black (all corners have the same colour since the sides lengths are both odd). This also implies the number of black squares is exactly one more than that of white squares, so there must contain a small rectangle that contains more black square than white squares. This will only happen when all this small rectangle has all four corners having black square. Now each of the four corners correspond to two adjacent sides of $\mathcal{R}$, and its distance from the two adjacent sides are both odd and both even if and only if it's coloured black. Since all these four corners are all black squares, the distance of the small rectangle from all four pairs of adjacent sides have the same parity, hence having the same parity to all the sides of $\mathcal{R}$. 
	
	\item[\textbf{C2}] Let $n$ be a positive integer. Define a chameleon to be any sequence of $3n$ letters, with exactly $n$ occurrences of each of the letters $a, b,$ and $c$. Define a swap to be the transposition of two adjacent letters in a chameleon. Prove that for any chameleon $X$ , there exists a chameleon $Y$ such that $X$ cannot be hanged to $Y$ using fewer than $3n^2/2$ swaps.
	
	\textbf{Solution.} For each of the $n^2$ pairs of $(a, b)$ we denote $s_{ab}$ to be the number of pairs of $(a, b)$ such that $a$ comes before $b$. Definte $s_{ba}, s_{ac}, s_{ca}, s_{bc}, s_{cb}$, respectively. Notice also that $s_{ab}+s_{ba}=s_{ac} + s_{ca}= s_{ac} + s_{ca} = n^2$. We first proceed with a lemma: at each swap of characters $i$ and $j$ (assume $i\neq j$ otherwise we just get one free swap without changing the sequence), the numbers $s_{ij}$ and $s_{ji}$ each changes by exactly one. To see why, if another character, say $k$, is not involved in the swap, then it comes before any other character $\ell$ after a swap if and only if it comes before that character $\ell$ before the swap. The only characters that can cause a change in the values $s_{\text{anything}}$ are $i$ and $j$ themselves, which will cause $s_{ij}$ to decrease by 1 and $s_{ji}$ to increase by 1 (asuming the sequenc changes from $ij$ to $ji$). 
	
	Now, to make this string $s$ to match another string $t$, we must have $s_{ij}=t_{ij}$ for any combination of $ij$, Consider the strings $t_1=a\cdots ab\cdots bc\cdots c$ and $t_2=c\cdots cb\cdots ba\cdots a$. In the first example, $t_{ab}=n^2, t_{ba}=0, t_{ac}=n^2, t_{ca}=0, t_{bc}=n^2, t_{cb}=0$; in the second example it's just the opposite: $t_{ab}=0, t_{ba}=n^2, t_{ac}=0, t_{ca}=n^2, t_{bc}=0, t_{cb}=n^2$. To change from $s$ to $t_1$ there must be at least $s_{ba}+s_{ca}+s_{cb}$ swaps; to change from $s$ to $t_2$ there must be at least $s_{ab}+s_{ac}+s_{bc}$ swaps. These two expressions add up to $3n^2$, so one of them must be at least $3n^2/2$. 
	
	\item[\textbf{C3}]Sir Alex plays the following game on a row of 9 cells. Initially, all cells are empty. In each move, Sir Alex is allowed to perform exactly one of the following two operations:
	\begin{itemize}
	\item Choose any number of the form $2^j$, where $j$ is a non-negative integer, and put it into an empty cell.
	\item Choose two (not necessarily adjacent) cells with the same number in them; denote that number by $2^j$. Replace the number in one of the cells with $2^{j+1}$ and erase the number in the other cell.
	\end{itemize}
	At the end of the game, one cell contains $2^n$, where $n$ is a given positive integer, while the other cells are empty. Determine the maximum number of moves that Sir Alex could have made, in terms of $n$.
	
	\textbf{Answer.} $2\sum_{i=1}^8\dbinom{n}{i} - 1$. \\
	\textbf{Solution.} We first show that in the process of creating the $2^n$, the sum of the numbers in nonempty cells at any moment must have at most 8 ones in its binary representation. To see why, we claim that $2^{a_1}+\cdots + 2^{a_k}$ has at most $k$ digits in its binary representation with equality if and only if all $a_i$'s are pairwise distinct. We proceed by induction: $k=1$ is clear. Now suppose that $c=2^{a_1}+\cdots + 2^{a_k}$ has at most $k$ one's in its binary expansion, and consider $c+2^{a_{k+1}}$. Let $j$ to be the least index $\ge a_{k+1}$ that has 0 on the binary representation of $c$, then $c+2^{a_{k+1}}$ has 1 on $j$ and 0 on all $i$ for all $i < j$ and $i \ge a_{k+1}$. Hence the net change of the 1's is $1 - (j - a_{k+1})\le 1$, with equality iff $j=a_{k+1}$, i.e. no bits flipped from 1 to 0. This established our boundary. As for the equality case, it means that there is no bits flipped from 1 to 0 at all, which follows that $a_1, a_2, \cdots a_k$ must be all distinct (it will become clear if we arrange the numbers in the way $a_1\ge\cdots a_k$). The fact that there are only 9 cells means that there are at most 9 one's in any numbers at all times. However, if equality actually holds, then all the nine numbers $2^{a_1}, \cdots , 2^{a_9}$ are pairwise different. The first operation cannot be done since there is no empty cell; the second operation cannot be done either since there is no two cells with the same number. This means the game must end here, but it doesn't end with the state of $2^n$ as desired. This shows that any number (that is the sum of the non-empty cells) any time has at most 8 one's in its binary digits. 
	
	Now we show that Sir Alex can do the algorithm such that all numbers with at most 8 one's and $\le 2^n$ can be sum of cells at some time. Now we identify all such numbers and sort it in ascending order. We use a stronger claim: we can do it such that at some point, any number with at most 8 one's is presented on the grid, represented exactly in the way of binary representation. Again we use induction, and we consider the next number with this property. We start with 0, obviously. At each point, suppose the number $c$ is represented on the grid in the manner we desire. We now have two cases: 
	\begin{itemize}
		\item If $c$ has at most 7 digits that are ones, then we can add another one at the cells. If $c$ is now even we are done (since $c+1$ will have 1 more one than $c$); otherwise, let $j$ be the minimal index such that the digits 0 to $j$ are all one. This means that $2^j, 2^{j - 1}. 1$ are all in the cells and, after adding 1, we can iteratively merge them so that a single 1 is left. 
		\item Otherwise, $c$ has exactly 8 digits. If $j$ is the least index such that $c$ has 1 at digit $j$, then the next number with the desired property is $c+2^{j}$ ($c+d$ with $1\le d<2^j$ has more digit than $c$ since $c$ is divisible by $2^j$). Now we add $2^j$, and do the merging in a fashion similar to the first case; the resulting configuration would be optimal. 
	\end{itemize}

Summarizing above, we will have $\sum_{i=1}^8\dbinom{n}{i}$ numbers represented in the process. This means $\sum_{i=1}^8\dbinom{n}{i}$ insertion of cell is done, which means the number of nonempty cells has been increased by $\sum_{i=1}^8\dbinom{n}{i}$ times. Since there is only one cell left, there are $\sum_{i=1}^8\dbinom{n}{i}-1$ decrement of the number cells, i.e. merging. Hence the total numbers of moves is $2\sum_{i=1}^8\dbinom{n}{i}-1$. 
\end{enumerate}

\section{Geometry}
\begin{enumerate}
	\item[\textbf{G1}] Let $ABCDE$ be a convex pentagon such that $AB=BC=CD$, $\angle{EAB}=\angle{BCD}$, and $\angle{EDC}=\angle{CBA}$. Prove that the perpendicular line from $E$ to $BC$ and the line segments $AC$ and $BD$ are concurrent.
	
	\textbf{Solution.} Let $P$ be the intersection of the diagonals $AC$ and $BD$, and $Q$ be the intersection of circles $ABP$ and $CDP$. Now, by angle chasing we get $\angle AQB=\angle APB=\angle CPD=\angle CQD$ and $\angle BAQ=\angle DPQ=\angle DCQ$, so the triangles $BAQ$ and $DCQ$ are similar. Since $AB=CD$, these triangles are in fact congruent, so $AC=CQ$ and $BQ=DQ$. Now, this means that $BQ$ is the perpendicular bisector of $AC$ and $CQ$ is the perpendicular bisector of $BD$. Thus $P$ is the orthocenter of triangle $BQC$. 
	
	The next step is to show that $E, P, Q$ are collinear, which finished the proof. To achieve this, we first observe that $\angle BAQ=\angle DPQ= 90^{\circ}-\angle PQC=90^{\circ} - \angle CBQ$. Now, $\angle BAE=\angle BCD=180^{\circ} - \angle CBQ - \angle CQB = 180^{\circ} - 2\angle CBQ=2\angle BAQ$, so $AQ$ is an angle bisector of $BAE$. We also know that $BQ$ bisects $\angle ABC$ since $BQ$ is the perpendicular bisector of $AC$, so the distance from $Q$ to lines $BC, BA, AE$ are equal. Similarly the distance from $Q$ to lines $BC, CD, DE$ are equal. Thus $EQ$ bisects $AED$ too. To see that $E, P, Q$ are collinear, or equivalently $EQ$ is perpendicular to $BC$, it suffices to show that if $EA$ and $ED$ intersect $BC$ at $L$ and $M$, respectively, then we have $EL=EM$. This is indeed true as it can be computed that $\angle ELM=\angle EML=180^{\circ} - 2\angle BAC- 2\angle CBD$. 
	
	\item[\textbf{G2}] (IMO \#4) Let $R$ and $S$ be different points on a circle $\Omega$ such that $RS$ is not a diameter. Let $\ell$ be the tangent line to $\Omega$ at $R$. Point $T$ is such that $S$ is the midpoint of the line segment $RT$. Point $J$ is chosen on the shorter arc $RS$ of $\Omega$ so that the circumcircle $\Gamma$ of triangle $JST$ intersects $\ell$ at two distinct points. Let $A$ be the common point of $\Gamma$ and $\ell$ that is closer to $R$. Line $AJ$ meets $\Omega$ again at $K$. Prove that the line $KT$ is tangent to $\Gamma$.
	
	\textbf{Solution.} One of the most crucial claim to the proof is that $AT\parallel KR$. To see why, $\angle TRK = \angle SRK = \angle SJK = \angle ATS=\angle ATR$. Next, since $AR$ is tangent to $\Omega$, we have $\angle ART=\angle ARS=\angle SKR$. Thus triangles $RKS$ and $TRA$ are similar. Now, let $B$ to be such that $A$ is the midpoint of $BT$. We have $\angle BAR=\angle TSK$ and $\frac{BA}{AR}=\frac{AT}{AR}=\frac{SR}{SK}$, so triangles $BAR$ and $TSK$ are also similar. Finally, since $S$ is the midpoint of $RT$ and $A$ the midpoint of $BT$, we have $BR\parallel AS$, so $\angle RTK=\angle RBA=\angle SAT$. The last inequality means that $KT$ is tangent to $\Gamma$. 
	
	\item[\textbf{G3}] Let $O$ be the circumcenter of an acute triangle $ABC$. Line $OA$ intersects the altitudes of  $ABC$ through $B$ and $C$ at $P$ and $Q$, respectively. The altitudes meet at $H$. Prove that the circumcenter of triangle $PQH$ lies on a median of triangle $ABC$. 
    
    \textbf{Solution.} Let $D$ be the altitude from $A$ to $BC$. We consider the homothety centered at $A$ bringing triangle $PQR$ to $DP'Q'$, which brings the circumcenter to $PQR$ to that of $DP'Q'$ too. It thus sufficient to show that the circumcenter of $DP'Q'$ lies on the median from $A$. 
    
    Now, $DP'$ is perpendicular to $AC$ by the definition of homothety (since $HP$ is perpendicular to $AC$). Let $AO$ intersect $BC$ at $F$, and the circumcircle of $ABC$ again at $E$ (so $AE$ is the diameter). Let the perpendicular from $E$ to $BC$ to be $G$. Then we have $\frac{DF}{FG}=\frac{AF}{FE}$ since $AD$ is perpendicular to $GE$. Similarly, since $DP'$ is parallel to $CE$, we have $\frac{DF}{FC}=\frac{P'F}{FE}$. Thus $DF\cdot FE=FG\cdot AF=P'F\cdot FC$, i.e. $\frac{FG}{FC}=\frac{P'F}{AF}$, i.e. $P'G\parallel AC$. This gives $DP'G=90^{\circ}$, and so the circumcenter of $DP'G$ is the midpoint of $DG$. In other words, the perpendicular bisector of $DP'$ passes through the midpoint $DG$. Analogously, we can also show that the perpendicular bisector of $DQ'$ passes through midpoint of $DG$. Thus the midpoint of $DG$ is actually the circumcenter of $DP'Q'$. Since $D$ and $G$ are symmetric with respect to the midpoint of $BC$ (well-known fact), the midpoint of $BC$ is indeed the circumcenter of $DP'Q'$, hence lying on the median from $A$. 
    	
	\item[\textbf{G4}] In triangle $ABC$, let $\omega$ be the excircle opposite to $A$. Let $D, E$ and $F$ be the points where $\omega$ is tangent to $BC, CA$, and $AB$, respectively. The circle $AEF$ intersects line $BC$ at $P$ and $Q$. Let $M$ be the midpoint of $AD$. Prove that the circle $MPQ$ is tangent to $\omega$.
	
	\textbf{Solution.} We first show that if $J\neq D$ is the second intersection of $AD$ with the excircle $\omega$ then $J$ lies on the circle $MPQ$, Let $I$ be the $A$-excenter, then $\angle AEI=\angle AFI=90^{\circ}$, so $I$ lies on circle $AEF$. Let $G\neq D$ be the second intersection of $AD$ with circle $AEF$, then $\angle AGI=\angle DGI=90^{\circ}$. Sincd $DJ$ is a chord on the excircle, and $G$ is the perpendicular from the cetner $I$ to $DJ$, $DG=GJ$. Finally, since $A, P, Q, E, F, G$ are concyclic, $PD\cdot DQ=AD\cdot DG=2MD\cdot DG=MD\cdot 2DG=MD\cdot DJ$, completing the proof of this claim. 
	
	It remains to show that circles $MPQ$ and $\omega$ are tangent at $J$. Let $PQ$ and $EF$ intersect at $H$ (possibly point of infinity), then since $PQ$ is the radical axis of circles $AEF$ and $MPQ$ and $EF$ the radical axis of $AEF$ and $\omega$, $H$ is the radical center of the three circles (i.e. the radical axis of $MPQ$ and $\omega$). Now, the tangents to $\omega$ at $E$, $C$, and line $DJ$ concur at $A$, so quadrilateral $EDCJ$ is harmonic. This means that the tangents to $\omega$ at $D$, at $J$, and $EF$ are concurrent too. Since $PQ$ is tangent to $\omega$, these lines must concur at $H$. We then conclude then $HJ$ is tangent to $\omega$ and since $HJ$ is the radical axis of $\omega$ and $MPQ$, they are indeed tangent. 
	
	\item[\textbf{G5}] Let $ABCC_1B_1A_1$ be a convex hexagon such that $AB=BC$, and suppose that the line segments $AA_1, BB_1$, and $CC_1$ have the same perpendicular bisector. Let the diagonals $AC_1$ and $A_1C$ meet at $D$, and denote by $\omega$ the circle $ABC$. Let $\omega$ intersect the circle $A_1BC_1$ again at $E \neq B$. Prove that the lines $BB_1$ and $DE$ intersect on $\omega$.
	
	\textbf{Solution.} Denote the common perpendicular bisector as $\ell$. Throughout the solution we observe the following facts: 
	\begin{itemize}
		\item $ABB_1A_1$, $ACC_1A_1$, $BCC_1B_1$ are isoceles trapezoid and are cyclic. 
		\item The intersection of diagonals of each of the trapezoids lie on $\ell$ (holds for $D$, in particular), so are the circumcenters of each of the trapezoids. 
		\item The intersection of the lateral sides of the trapezoids also lie on $\ell$; here we are particularly interested in $P=AC\cap A_1C_1$. 
	\end{itemize}
    First we show that $B, E, P$ are collinear. Indeed, the power of point of $P$ to circle $\omega$ is $PA\cdot PC$ and the power of point of $P$ to circle $A_1BC_1$ is $PA_1\cdot PC_1$. Since $PA=PA_1$ and $PC=PC_1$, $P$ lies on the radical axis of the two circles, which is $BE$. Next, denote $O$ as the circumcenter of $AA_1C_1C$. We have $\angle AOC=2\angle AC_1C=2\angle DC_1C=\angle DC_1C+\angle DCC_1=\angle ADC$, so $ACOD$ is cylic, i.e. $PB\cdot PE=PA\cdot PC=PO\cdot PD$ (recall that $P, D, O$ are collinear, so are $P, E, B$ as proven). Thus $BEDO$ is also cyclic. 
    
    Now let $DE$ and $BB_1$ intersect at $X$. Recall that $BB_1$ and $\ell$ are perpendicular, and that $EBOD$ is cyclic, which gives $\angle PBX+\angle EXB=\angle PEX=\angle PED=\angle POB$, i.e. $\angle EXB=\angle POB-\angle PBX=\angle POB-(\angle PBO-\angle XBO)=90^{\circ}-\angle PBO$ (since $PO$ and $BX$ are perpendicular). Now $\angle PBO=\angle EBO=\angle ABO+\angle EBA=90^{\circ}-\angle BAC+\angle EAB$, so $\angle EXB=\angle BAC-\angle EBA=\angle BCA-\angle ECA=\angle BCE$, so $X$ lies on the circle $ABCE$ which is $\omega$, indeed. 
	
	\item[\textbf{G7}] A convex quadrilateral $ABCD$ has an inscribed circle with center $I$. Let $I_a, I_b, I_c$ and $I_d$ be the incenters of the triangles $DAB, ABC, BCD$ and $CDA$, respectively. Suppose that the common external tangents of the circles $AI_bI_d$ and $CI_bI_d$ meet at $X$, and the common external tangents of the circles $BI_aI_c$ and $DI_aI_c$ meet at $Y$. Prove that $\angle{XIY}=90^{\circ}$.
	
	\textbf{Solution.} We first notice two lemmas: 
	\begin{itemize}
		\item $I_BI_D$ is perpendicular to $AC$. Indeed, the fact that $ABCD$ has an inscribed circle means that $AB+CD=AD+BC$ (readers can verify this by considering the point-of-tangency of the incircle with the four sides, and by considering the power of point from vertices $A, B, C, D$ to the incircle). Now, if $T_B$ and $T_D$ are the point of tangency of the incircles $ABC$ and $ACD$ then we have $AT_B-T_BC=AB-BC=AD-DC=AT_D-T_DC$. This means $T_B$ and $T_D$ coincides, and the lemma follows. Similarly $I_AI_C$ is perpendicular to $BD$. 
		\item Let $O_A$ and $O_C$ to be the circumcenters of $AI_BI_D$ and $CI_BI_D$, respectively. Then they lie on the lines $AI, CI$, respectively. Indeed, since $AC$ is perpendicular to $I_BI_D$, $AO_A$ and $AC$ are symmetric about the internal angle bisector of $\angle I_BAI_D$. This means that $I_BAC=I_DAA_O$ and $I_DAC=I_BAA_O$. Also, $\angle BAI=\angle DAI$ by the property of inscribed circle, so $\angle I_BAI+\angle I_BAC=\angle I_BAI+\angle I_BAB=\angle BAI=\angle DAI=\angle I_DAI+\angle I_DAD=\angle I_DAI+\angle I_DAC$, where we also used the fact that $AI_B$ bisects $\angle BAC$ and $AI_D$ bisects $\angle CAD$. Since $\angle I_BAI_D=\angle I_BAI+\angle I_DAI=\angle I_BAC+\angle I_DAC$, the condition $\angle I_BAI=\angle I_DAC$ and $\angle I_DAI=\angle I_BAC$ must hold true, hence proving that $O_A$ lies on $AI$. Similarly, $O_C$ lies on $CI$. 
	\end{itemize}
    With these, we first notice that $I_BI_D$ is the radical axis of the circles $AI_BI_D$ and $CI_BI_D$, so $O_AO_C$ is perpendicular to $I_BI_C$ too. This gives $O_AO_C\parallel AC$, so $\frac{IO_A}{IO_C}=\frac{AO_A}{CO_C}$ (notice that the last ratio is the ratio of the radii of the circles $AI_BI_D$ and $CI_BI_D$). Since $X$ is the intersection of the common external tangents of the two circles, it lies on $O_AO_C$ and satisfies $\frac{XO_A}{XO_C}=\frac{AO_A}{CO_C}=\frac{IO_A}{IO_C}$. Thus by the angle bisector theorem, $XI$ is the external angle bisector of $\angle O_AIO_C$, also the external angle biector of $AIC$. Similarly, $YI$ is the external angle bisector of $BID$. 
    
    It then remains to prove that the external angle bisectors of $AIC$ and $BID$ are perpendicular to each other. Let the inscribed circle of $ABCD$ to be tangent to $AB, BC, CD, DA$ to points $U, V, W, Z$, respectively. Then $AI$ is perpendicular to $UZ$ and $CI$ is perpendicular to $VW$. Thus the external angle bisector of $AIC$ is also an angle bisector of $UZ$ and $VW$. Similarly the external angle bisector of $BID$ is an angle bisector of $UV$ and $ZW$. As $UVWZ$ is cyclic, these angle bisectors are perpendicular to each other, hence the result. 
	\end{enumerate}

\section{Number Theory}
\begin{enumerate}
	\item[\textbf{N1}](IMO \#1) For each integer $a_0 > 1$, define the sequence $a_0, a_1, a_2, \ldots$ for $n \geq 0$ as
	$$a_{n+1} = 
	\begin{cases}
	\sqrt{a_n} & \text{if } \sqrt{a_n} \text{ is an integer,} \\
	a_n + 3 & \text{otherwise.}
	\end{cases}
	$$Determine all values of $a_0$ such that there exists a number $A$ such that $a_n = A$ for infinitely many values of $n$.
	
	\textbf{Answer.} All $n$ divisible by 3. \\
	\textbf{Solution.} 
	For the first part we show the that if $3\nmid a_0$, then $a_i\equiv 2\pmod{3}$ for some $i$. Notice first that if $3\nmid a_i$ then $3\nmid a_{i+1}$ (regardless whether $a_i$ is a perfect square). If $a_0$ has remainder 2 modulo 3 we are done. Otherwise, $a_0\equiv 1\pmod{3}$ so $a_0+3k$ is a perfect square for some $k$. Find the minimal such $k$, and we have $a_k=a_0+3k=c^2$ for some $c$, and $a_{k+1}=c$. If $c\equiv 2\pmod{3}$ we are done. Otherwise, we have $c\ge 4$ and $c-2\equiv 2\pmod{3}$ so $(c-2)^2\equiv 1\pmod{3}$, showing that $a_0\ge (c-2)^2+3$. With $c\ge 4$ we have $(c-2)^2+3 > c$, so $a_0>a_{k+1}$. Letting $0=b_0$ and $b_1, b_2, \cdots$ be indices such that $a_{b_i}$ is a perfect square yields that $a_{b_0}>a_{b_1}>\cdots$, so this sequence must terminate, meaning that we have $a_i\equiv 2\pmod{3}$ for some $i$. Now it's easy to prove that this $a_i$ cannot be a perfect square, so for all $j>0$ we have $a_{i+j}=a_i+3j$, showing that all numbers appear a finite number of times. 
	
	For the case where $3|a_0$ we will do something similar: keep looking for the next square. Again let $k$ be the least index with $a_k$ a perfect square, say, $c^2$. Then $a_0\ge (c-3)^2+3$ because $3|c$. Now if $c>3$ then $c=a_{k+1}>a_0$, so again constructing the sequence $b_0, b_1, \cdots$ gives $a_{b_0}>a_{b_1}>\cdots$, hence it must terminate. The only way to terminate is when $c\le 3$, in which the equality must hold since $a_i>0$ for all $i$. Hence the sequence goes $3\to 6\to 9\to 3\to 6\to 9$, so each of $3, 6, 9$ appears infinitely many times. 
	
	\item[\textbf{N2}]Let $ p \geq 2$ be a prime number. Eduardo and Fernando play the following game making moves alternately: in each move, the current player chooses an index $i$ in the set $\{1,2,\ldots, p-1 \}$ that was not chosen before by either of the two players and then chooses an element $a_i$ from the set $\{0,1,2,3,4,5,6,7,8,9\}$. Eduardo has the first move. The game ends after all the indices have been chosen .Then the following number is computed:
	$$M=a_0+a_110+a_210^2+\cdots+a_{p-1}10^{p-1}= \sum_{i=1}^{p-1}a_i10^i$$
	The goal of Eduardo is to make  $M$ divisible by $p$, and the goal of Fernando is to prevent this.
	
	Prove that Eduardo has a winning strategy.
	
	\textbf{Solution.} If $p=2$ or $p=5$, Eduardo just have to choose $a_0=0$ and the games is his, forever. Hence from now on we assume that $\gcd(p, 10)=1$. Eduardo first lets $a_{p-1}=0$. Then he considers $10^j\pmod{p}$ for $j=0, \cdots , p-2$, and consider the minimum $k$ such that $10^k=1\pmod{p}$. Now two cases arise: 
	\begin{itemize}
		\item If $k$ is even, then it must happen that $10^{k/2}\equiv -1\pmod{p}$. Now pair the indices $0, 1, \cdots , p-2$ in the following manner: if $j=ak+b$ with $0\le b<k$ then pair $j$ with $j + k/2$ if $b<k/2$, and with $j - k/2$ otherwise. Now notice that if $j, \ell$ are a pair then $10^j$ and $10^{\ell}$ are negatives of each other, and these pairs form a partition of the numbers $0, 1, \cdots , p - 2$. Now at each turn, Fernando chooses $j$ and $a_j$, and is $j$ is paired with $\ell$ then Eduardo chooses $\ell$ with $a_\ell = a_j$, so that $a_j10^j+a_\ell10^{\ell}\equiv 0\pmod{p}$. This will allow $p|M$ in the end. 
		\item Otherwise, let $b_j=10^j$ for all $0, 1, \cdots , k-1$. Notice that $(p-1)/k$ must be even, so for each $j$ there are an even number of indices $\ell$ with $10^{\ell}\equiv b_j\pmod{p}$. Now for each $j$ and all such $(p-1)/k$ $\ell$'s, we pair the indices arbitrarily (so that there are $(p-1)/2k$ pairs). Each time when when Fernando chooses $j$ and $a_j$, and suppose that $j$ is paired with some $\ell$, Eduardo chooses $a_\ell=9-a_j$, so that the contribution to $M$ mod $p$ is $9b_j$. Therefore, the resulting $M$ has congruence $\sum 9*(p-1)*b_j/(2k)=9*(p-1)/2k\sum b_j$. If $p=3$ the factor 9 already implies $3|M$. Otherwise, notice that $(p-1)/k\sum b_j=\sum_{i=0}^{p-2}10^{j}=\frac{10^{p-1}-1}{10-1}$, which is divisible by $p$ since $p|10^{p-1}-1$ by Fermat's little theorem, and $p\nmid 9=10-1$ for $p\neq 3$. Since $(p-1)/k$ is not a multiple of $p$, $\sum b_j$ is a multiple of $p$, and so is $9*(p-1)/2k\sum b_j$ and $M$. 
	\end{itemize}
    
    \item[\textbf{N3}] Determiner all integers $ n\geq 2$ having the following property: for any integers $a_1,a_2,\ldots, a_n$ whose sum is not divisible by $n$, there exists an index $1 \leq i \leq n$ such that none of the numbers $$a_i,a_i+a_{i+1},\ldots,a_i+a_{i+1}+\ldots+a_{i+n-1}$$is divisible by $n$. Here, we let $a_i=a_{i-n}$ when $i >n$.
    
    \textbf{Answer.} All $n$ that are prime. \\
    \textbf{Solution.} Suppose first that $n$ is composite, and write $n=ab$ with $1<a, b<n$. We gave a counterexample that makes this statement fail. Consider the sequence $a, a, \cdots a, 0$, which has sum $a(n-1)$ which has remainder $-a\neq 0$ mod $n$. If $1\le i\le n-b$ then $a_i+a_{i+1}+\cdots + a_{i+b-1}=a+a+\cdots + a=ab=n$ which is divisible by $n$< so such $i$ won't work. Otherwise, if $n-b\le i\le n$ then $a_i+\cdots + a_{i+b}=a_i+\cdots + a_n+a_1+\cdots +a_{i + b - n}=ab=n$, so such $i$ won't work either. Thus we have just found a counterexample sequence such that none of the $i$'s work. 
    
    Conversely, if $n$ is a prime, we consider the sequence on a circle. Let $r$ to be the remaidner of $a_1+\cdots +a_n\pmod{n}$, and we have $\gcd(r, n)=1$. Consider the new sequence $a_1, a_1+a_2, \cdots a_1+\cdots +a_n, a_1+\cdots + a_n+a_1, \cdots , \underbrace{a_1+\cdots+a_n}_{\text{$n$ times}}$. If this sequence is named as $b_1, b_2, \cdots b_{n^2}$ then $b_{n+i}-b_i=r\pmod{n}$. Thus for all $i$ the sequence $\{b_i, b_{i+n}, \cdots b_{i + (n-1)n}\}$ leaves distinct remainders mod $n$, and each remainder $0, 1, \cdots n-1$ appears $n$ times in $b_1, b_2, \cdots b_{n^2}$. Since $b_{n^2}=n(a_1+\cdots a_n)=0\pmod{n}$, we can, again, wrap them on a circle. Now consider $\{i:b_i=0\}$. Since there are $n$ such $i$'s on the circle on $n^2$ numbers, there are two consecutive such $i$'s that are at least $n$ steps apart. If there's no condecutive such $i$'s that are more than $n$ steps apart, then any two consecutive $i$'s must be exactly $n$ steps apart, so $0=b_i=b_{n+i}=\cdots=b_{n(n-1)+i}$, contraidcting $b_{n+i}-b_i=r\pmod{n}$. So we have $b_i=b_j=0$ with $j-i>n$, with $b_k\neq 0$ for all $i<k<j$. Thus we can choose $a_{i+1}, a_{i+1}+a_{i+2}, \cdots, a_{i+1}+\cdots a_{i+n}$ that are exactly $b_{k}-b_i$ for all $i+1\le k\le i+n$, and none of them is divisible by $n$. 
    
    \item[\textbf{N4}]
    Call a rational number short if it has finitely many digits in its decimal expansion. For a positive integer $m$, we say that a positive integer $t$ is $m-$tastic if there exists a number $c\in \{1,2,3,\ldots ,2017\}$ such that $\dfrac{10^t-1}{c\cdot m}$ is short, and such that $\dfrac{10^k-1}{c\cdot m}$ is not short for any $1\le k<t$. Let $S(m)$ be the set of $m-$tastic numbers. Consider $S(m)$ for $m=1,2,\ldots{}.$ What is the maximum number of elements in $S(m)$?
    
    \textbf{Answer.} 807. 
    
    \textbf{Solution.} 
    A rational number is short iff it's in the form of $\frac pq$ where $\gcd(p, q)=1$ and $q$ has no prime divisor other than 2 or 5. 
    In particular, $\frac{10^t-1}{cm}$ short means $\gcd(cm, 10)=1$
    so $S(m)=0$ whenever $2\mid m$ or $5\mid m$. 
    
    Now we focus on cases where $\gcd(m, 10)=1$, 
    and notice that $t$ being $m$-tastic means that $\ord_{cm}(10)=t$ for some $c$ (here $\ord$ means the order of 10 modulo $cm$ for $\gcd(cm, 10)=1$). 
    The valid $c$'s are 
    \[
    \{c=1, \cdots, 2017: c\equiv 1, 3, 7, 9\pmod{10}\}
    \]
    which we can verify there are 807 of them. 
    It follows that at most 807 of those $t$'s have $\ord_{cm}(10)=t$ for some $c$ for any given $m$. 
    
    To show that equality can be obtained, 
    let's show that there exists $m$ such that $\ord_{cm}(10)$ are different for each $c$. 
    In fact, we'll show the following: 
    
    \emph{Lemma.} 
    There exists $m$ such that $\ord_{cm}(10)=c\cdot\ord_m(10)$. 
    
    Proof: Choose $m=10^T-1$ for some $T$, then $\ord_m(10)=T$. 
    Let's choose $T$ such that $\ord_c(10)\mid T$ for all $c=3, \cdots, 2017$ such that $\gcd(c, 10)=1$. 
    That way $c\mid m$. 
    
    Now, to find the minimum $k$ with $cm\mid 10^k-1$, 
    we first note that $m\mid 10^k-1$ iff $k$ is divisible by $\ord_m(10)=T$, so $k=\ell T$. 
    Consider the following: 
    \[
    10^{\ell T}-1
    =(m+1)^{\ell}-1
    =\sum_{i=1}^{\ell}\binom{\ell}{i}m^{i}
    \]
    and since $c\mid m$, we have 
    \[
    \sum_{i=1}^{\ell}\binom{\ell}{i}m^{i}
    \equiv \ell m
    \]
    so the minimum such $\ell$ is indeed $c$, so $\ord_{cm}(10)=cT$, as desired. 
    
    \item[\textbf{N5}] Find all pairs $(p,q)$ of prime numbers which $p>q$ and
    $$\frac{(p+q)^{p+q}(p-q)^{p-q}-1}{(p+q)^{p-q}(p-q)^{p+q}-1}$$is an integer.
    
    \textbf{Answer.} $(p, q)=(3, 2)$. \\
    \textbf{Solution.} The aforementioned pair claims that $5^1-1|5^5-1$, which holds true because $5^5-1=3124=778\times 4$. We now show there are no other pairs. 
    For the rest of the part, $D=(p+q)^{p-q}(p-q)^{p+q}-1$. 
    
    Now suppose that $D|(p+q)^{p+q}(p-q)^{p-q}-1$, we also have 
    $D|((p+q)^{p+q}(p-q)^{p-q}-1) - ((p+q)^{p-q}(p-q)^{p+q}-1)
    =(p+q)^{p-q}(p-q)^{p-q}((p+q)^{2q}-(p-q)^{2q}). 
    $
    We'll split into two cases: 
    
    \emph{Case 1.} $q=2$. 
    Here, if $p>3$, then $(p-q)^{2q} < (p-q)^{p+q} <= D$. If $(p+q)^{2q}>=D+1$ then we have $(p+q)^{2q}\ge (p+q)^{p-q}(p-q)^{p+q}$, a.k.a. $(p+q)^{3q-p}\ge (p-q)^{p+q}$ which means $3q\ge p$, hence $p\le 5$. For $p=5$ we have $7\ge 3^{7}$, which is absurd. Hence $(p+q)^{2q} <= D$ in the primes we are considering, and with $(p-q)^{2q}<D$ we will need $(p+q)^{2q}=(p-q)^{2q}$, contradiction since this implies $p+q=p-q$. 
    
    \emph{Case 2.} $q>2$. 
    Consider this: 
    
    \emph{Lemma.} If $p$ and $q$ are odd primes and $r$ is an odd prime with $r\mid (p+q)^{2q}-(p-q)^{2q}$, then either $r=p, r=q$m or $r\equiv 1\pmod{q}$. 
    
    Proof: otherwise, $\gcd(r-1, 2q)=2$ so there's $k$ such that $2qk\equiv 2\pmod{r}$, i.e. 
    \[
    (p+q)^2\equiv (p+q)^{2qk}\equiv  (p-q)^{2qk}\equiv (p-q)^2
    \]
    so $r\mid 4pq$. So $r=p$ or $q$ here. $\square$ 
    
    Now we see that our $D$ has only prime divisors that could be $p, q,$ or $r=qk+1$ for some $k$. 
    If $p\mid D$ then 
    \[
    0\equiv (p+q)^{p-q}(p-q)^{p+q}-1
    \equiv q^{p-q}(-q)^{p+q}-1
    =q^{2p}-1\equiv q^2-1
    \]
    so either $p\mid q-1$ or $p\mid q+1$. But this is impossible for $q<p$ and both being odd. 
    
    This reduces to $q$ and those primes $\equiv 1\pmod{q}$. 
    Since $p, q$ both odd, we have the factorization 
    \[
    (p+q)^{p-q}(p-q)^{p+q}-1
    =((p+q)^{\frac{p-q}{2}}(p-q)^{\frac{p+q}{2}}-1)((p+q)^{\frac{p-q}{2}}(p-q)^{\frac{p+q}{2}}+1)
    \]
    and with each factor having primes in terms of $q$ or $qk+1$ each of these must be either 0 or 1 mod $q$. 
    This is impossible as the factors differ by 2. 
	\end{enumerate}

\end{document}